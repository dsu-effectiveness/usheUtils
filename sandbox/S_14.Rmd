---
title: "S-14"
output: html_document
date: '2022-06-01'
---

```{r set global chunks, include=FALSE}
knitr::opts_chunk$set(
  warning = FALSE, message = FALSE
)
```

```{r load libraries}
library(tidyverse)
library(datasets)
library(plotly)
library(gt)
library(glue)
library(stringr)
library(DT)
library(purrr)
```

## Where does the data come from

Outline where in Edify this data comes from. This should come from the spread sheet. 

### Create fake data that matches this.

```{r}
test_df <- tibble(
  person_id = sample(1:99999999, 10),
  is_hispanic = sample(c(TRUE, FALSE), 10, replace = TRUE),
  is_asian = sample(c(TRUE, FALSE), 10, replace = TRUE) 
) %>% 
    mutate(person_id = str_pad(person_id, 10, pad = '0'))

DT::datatable(test_df)
```


## The function that formats it

The first thing I need to do is to figure out how to turn a true into a letter and false into a space.

```{r}
change_hispanic <- function(boolean) {
  # TODO: talk with Andrea about what to do with missing values.
  # TODO: What to do if the input is not a boolean value.
  if_else(boolean, 'H', ' ', missing = ' ')
}
```


What does this do to test_df?

```{r}
hispanic_test <- test_df %>% 
  mutate(is_hispanic_test = change_hispanic(is_hispanic))

datatable(hispanic_test)
```

Now we will do the same thing for asians.
```{r}
change_asian <- function(boolean) {
  # TODO: talk with Andrea about what to do with missing values.
  # TODO: What to do if the input is not a boolean value.
  if_else(boolean, 'A', ' ', missing = ' ')
}

# case_when might be a better way to handle this.
```

```{r}
a_and_h_test <- test_df %>% 
  mutate(is_hispanic_test = change_hispanic(is_hispanic)) %>% 
  mutate(is_asian_test = change_asian(is_asian))

datatable(a_and_h_test)
```

Paste idea
```{r}
a_and_h_paste <- a_and_h_test %>% 
  select(person_id, is_hispanic_test, is_asian_test) %>% 
  unite()
```

